---
title: "Case Study 01 - Beers"
author: "Randall Hendrickson"
date: "October 6, 2017"
output: html_document
params:
  state: "TX"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Case Study 01

# read data file (does not run code) 
# - actually it appears it does read code
```{r, code=readLines("./scripts/DataSetup.R")}
#require()
#read_chunk('./DataSetup.R')
```

Beers

## Questions

#### 1. How many breweries are present in each state?

```{r questions}

library(data.table)
library(dplyr)
library(ggplot2)

mydt <- setDT(breweries)[, .(count = uniqueN(Brewery_id)), by = State]
setorder(mydt, State)
mydt

# use dplyr
mydt2 <- breweries
mydt2 %>% group_by(State) %>% summarize(count=n()) %>% print(n = 100)

```

#### 2. Merge beer data with the brewery data.

```{r question2}

# merge beer data and brewery data

beer_world <- merge(beers, breweries, by = "Brewery_id")
names(beer_world)[names(beer_world) == "Name.x"] <- "Beer_Name"
names(beer_world)[names(beer_world) == "Name.y"] <- "Brewery_Name"

# print first 6 observations
head(beer_world, 6)

# print last 6 observations
tail(beer_world, 6)

```

#### 3. Report the number of NS's in each column

```{r question3}

# report number of NAs

num_NAs <- sapply(beer_world, function(x) sum(is.na(x)))
num_NAs

```

#### 4. Compute the median alcohol content and international bitterness unit for each state.

```{r question_4}
#4 compute the median alcohol content and IBU for each state Plot a bar chart to compare

state_ABV <- aggregate(beer_world["ABV"], by=beer_world[c("State")], FUN=median, na.rm=TRUE)
barplot(state_ABV$ABV, main="Beer ABV by State", names.arg = state_ABV$State)

state_IBU <- aggregate(beer_world["IBU"], by=beer_world[c("State")], FUN=median, na.rm=TRUE)
barplot(state_IBU$IBU, main="Beer IBU by State", names.arg = state_IBU$State)

```

#### 5. Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?

```{r question_5}

# max ABV
state_ABV[which.max(state_ABV$ABV),]

# max IBU
state_IBU[which.max(state_IBU$IBU),]

```

#### 6. Summary statistics for the ABV variable.

```{r question_6}

summary(state_ABV)

```

#### 7. Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.

```{r beer_plot}

ggplot(beer_world, aes(x = IBU, y = ABV)) + 
  geom_point(colour = 'red', size = 1, na.rm=TRUE) + 
  labs(title = "Relationship between Bitterness and Alcohol content", subtitle = "Is bitter better?") + 
  labs(caption = "(based on data from ...?? where's the data from ??)") +
  geom_smooth(method=lm, se=FALSE, size = 1, na.rm=TRUE)

```


```{r state_to_analyze}

cat(paste("This is the state to analyze:", params$state))



```


## Reproducible Research

Include the session info, e.g. this document is produced with **knitr**. 
Here is the session info:


```{r session-info}
print(sessionInfo(), locale=FALSE)

```




